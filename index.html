<!doctype html>
<html lang="ko">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fraction Lunch Chef</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body, #app-container {
      height: 100%;
      width: 100%;
    }

    #app-container {
      font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow-auto;
      padding: 24px;
    }

    .game-wrapper {
      max-width: 1200px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 32px;
      color: white;
    }

    .header h1 {
      font-size: 48px;
      margin-bottom: 12px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      font-weight: 900;
    }

    .header p {
      font-size: 24px;
      opacity: 0.95;
      font-weight: 600;
      line-height: 1.5;
    }

    .disclaimer {
      font-size: 16px;
      margin-top: 8px;
      opacity: 0.85;
    }

    .goal-panel {
      background: white;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .goal-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 16px;
      color: #4a5568;
    }

    .goal-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }

    .goal-item {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      padding: 16px;
      border-radius: 12px;
      text-align: center;
      color: white;
    }

    .goal-item.carb { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }
    .goal-item.prot { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
    .goal-item.fat { background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%); }

    .goal-label {
      font-size: 14px;
      margin-bottom: 8px;
      opacity: 0.9;
    }

    .goal-value {
      font-size: 28px;
      font-weight: bold;
    }

    .goal-item.achieved {
      box-shadow: 0 0 20px rgba(72, 187, 120, 0.6);
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .main-content {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 24px;
    }

    .menu-section {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      max-height: 600px;
      overflow-y: auto;
    }

    .menu-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 16px;
      color: #4a5568;
    }

    .menu-category {
      margin-bottom: 20px;
    }

    .category-label {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #667eea;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .menu-item {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 12px;
      border-radius: 10px;
      cursor: grab;
      transition: all 0.2s;
      border: 2px solid transparent;
    }

    .menu-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      border-color: #667eea;
    }

    .menu-item:active {
      cursor: grabbing;
    }

    .item-name {
      font-size: 18px;
      margin-bottom: 8px;
    }

    .item-nutrients {
      font-size: 13px;
      color: #2d3748;
      font-weight: 600;
      line-height: 1.4;
    }

    .nutrient-carb {
      color: #f97316;
    }

    .nutrient-prot {
      color: #3b82f6;
    }

    .nutrient-fat {
      color: #10b981;
    }

    .tray-section {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }

    .tray-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #4a5568;
    }

    .tray-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      grid-template-rows: auto auto;
      gap: 16px;
      margin-bottom: 24px;
    }

    .tray-slot:nth-child(1) {
      grid-column: 1 / 3;
    }

    .tray-slot:nth-child(2) {
      grid-column: 3 / 5;
    }

    .tray-slot:nth-child(3) {
      grid-column: 5 / 7;
    }

    .tray-slot:nth-child(4) {
      grid-column: 1 / 4;
    }

    .tray-slot:nth-child(5) {
      grid-column: 4 / 7;
    }

    .tray-slot {
      background: linear-gradient(145deg, #e8e8e8 0%, #f5f5f5 50%, #e8e8e8 100%);
      border: 4px solid #c0c0c0;
      border-radius: 8px;
      padding: 20px;
      min-height: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.1);
      position: relative;
    }

    .tray-slot::before {
      content: '';
      position: absolute;
      top: 3px;
      left: 3px;
      right: 3px;
      bottom: 3px;
      border-radius: 4px;
      border: 1px solid rgba(255,255,255,0.3);
      pointer-events: none;
    }

    .tray-slot.drag-over {
      background: linear-gradient(145deg, #d5d5d5 0%, #e5e5e5 50%, #d5d5d5 100%);
      border-color: #667eea;
      transform: scale(1.02);
      box-shadow: inset 0 2px 8px rgba(102, 126, 234, 0.2), 0 4px 8px rgba(102, 126, 234, 0.3);
    }

    .tray-slot.filled {
      background: linear-gradient(145deg, #f8f8f8 0%, #ffffff 50%, #f8f8f8 100%);
      border-color: #a8a8a8;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.1);
    }

    .slot-label {
      font-size: 14px;
      color: #718096;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .slot-content {
      text-align: center;
      width: 100%;
    }

    .slot-emoji {
      font-size: 40px;
      margin-bottom: 8px;
    }

    .slot-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
      color: #2d3748;
    }

    .slot-nutrients {
      font-size: 11px;
      color: #4a5568;
    }

    .remove-btn {
      background: #fc8181;
      color: white;
      border: none;
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
      margin-top: 8px;
      transition: background 0.2s;
    }

    .remove-btn:hover {
      background: #f56565;
    }

    .current-totals {
      background: #edf2f7;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .totals-title {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 12px;
      color: #4a5568;
    }

    .totals-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .total-item {
      text-align: center;
      padding: 12px;
      background: white;
      border-radius: 8px;
    }

    .total-label {
      font-size: 12px;
      color: #718096;
      margin-bottom: 4px;
    }

    .total-value {
      font-size: 20px;
      font-weight: bold;
      color: #2d3748;
    }

    .actions {
      display: flex;
      gap: 12px;
    }

    .btn {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-check {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-check:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-reset {
      background: #e2e8f0;
      color: #4a5568;
    }

    .btn-reset:hover {
      background: #cbd5e0;
    }

    .btn-hint {
      background: #48bb78;
      color: white;
    }

    .btn-hint:hover {
      background: #38a169;
    }

    .result-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .result-modal.show {
      display: flex;
    }

    .result-content {
      background: white;
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      max-width: 500px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .result-content.success {
      border: 4px solid #48bb78;
    }

    .result-content.fail {
      border: 4px solid #f56565;
    }

    .result-message {
      font-size: 24px;
      margin-bottom: 20px;
      color: #2d3748;
    }

    .hint-box {
      background: #fff5e1;
      border: 2px solid #ffc107;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 20px;
      display: none;
    }

    .hint-box.show {
      display: block;
    }

    .hint-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: #f57c00;
    }

    .hint-text {
      font-size: 14px;
      color: #5d4037;
    }

    .mixed-fraction {
      display: inline-block;
      vertical-align: middle;
    }

    .whole-number {
      display: inline-block;
      margin-right: 2px;
    }

    .fraction {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      vertical-align: middle;
      font-size: 0.75em;
      margin: 0 1px;
    }

    .fraction-numerator {
      border-bottom: 1px solid currentColor;
      padding: 0 3px;
      line-height: 1;
    }

    .fraction-denominator {
      padding: 0 3px;
      line-height: 1;
    }

    .footer {
      text-align: center;
      color: #000000;
      padding: 20px 0;
      font-size: 14px;
      margin-top: 40px;
    }

    @media (max-width: 768px) {
      .main-content {
        grid-template-columns: 1fr;
      }

      .goal-grid {
        grid-template-columns: 1fr;
      }

      .tray-grid {
        grid-template-columns: 1fr;
      }

      .tray-slot:nth-child(1),
      .tray-slot:nth-child(2),
      .tray-slot:nth-child(3),
      .tray-slot:nth-child(4),
      .tray-slot:nth-child(5) {
        grid-column: auto;
      }

      .menu-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div id="app-container">
   <div class="game-wrapper">
    <div class="header">
     <h1 id="app-title">ğŸ‘¨â€ğŸ³ ë¶„ìˆ˜ ê¸‰ì‹ ìš”ë¦¬ì‚¬ Season2</h1>
     <p id="instruction-text">ë¯¸ì…˜: ì´ˆë“±í•™ìƒ í•œë¼ ê¶Œì¥ ì˜ì–‘ì†ŒëŠ” íƒ„ìˆ˜í™”ë¬¼:5 ë‹¨ë°±ì§ˆ:3 ì§€ë°©:2 ì…ë‹ˆë‹¤. ê¶Œì¥ ì˜ì–‘ì†Œì— ë§ì¶° ê¸‰ì‹ ë©”ë‰´íŒì„ êµ¬ì„±í•´ë³´ì„¸ìš”.</p>
     <p class="disclaimer">â€»ì‹¤ì œ ìŒì‹ ì˜ì–‘ì†Œì™€ ë‹¤ë¦…ë‹ˆë‹¤.</p>
    </div>
    <div class="goal-panel">
     <div class="goal-title" id="goal-label">
      ğŸ¯ ì˜ì–‘ ëª©í‘œ
     </div>
     <div class="goal-grid">
      <div class="goal-item carb">
       <div class="goal-label">
        íƒ„ìˆ˜í™”ë¬¼
       </div>
       <div class="goal-value"><span id="current-carb">0</span> / 5
       </div>
      </div>
      <div class="goal-item prot">
       <div class="goal-label">
        ë‹¨ë°±ì§ˆ
       </div>
       <div class="goal-value"><span id="current-prot">0</span> / 3
       </div>
      </div>
      <div class="goal-item fat">
       <div class="goal-label">
        ì§€ë°©
       </div>
       <div class="goal-value"><span id="current-fat">0</span> / 2
       </div>
      </div>
     </div>
    </div>
    <div class="main-content">
     <div class="menu-section">
      <div class="menu-title">
       ğŸ“‹ ë©”ë‰´íŒ
      </div>
      <div class="menu-category">
       <div class="category-label">
        ğŸš ë°¥ë¥˜
       </div>
       <div class="menu-grid" id="rice-menu"></div>
      </div>
      <div class="menu-category">
       <div class="category-label">
        ğŸ² êµ­ë¥˜
       </div>
       <div class="menu-grid" id="soup-menu"></div>
      </div>
      <div class="menu-category">
       <div class="category-label">
        ğŸ¥˜ ë°˜ì°¬ë¥˜
       </div>
       <div class="menu-grid" id="side-menu"></div>
      </div>
     </div>
     <div class="tray-section">
      <div class="tray-title">
       ğŸ½ï¸ ë‚´ ìŸë°˜
      </div>
      <div class="hint-box" id="hint-box">
       <div class="hint-title">
        ğŸ’¡ íŒíŠ¸
       </div>
       <div class="hint-text" id="hint-text"></div>
      </div>
      <div class="current-totals">
       <div class="totals-title">
        í˜„ì¬ ì˜ì–‘ì†Œ
       </div>
       <div class="totals-grid">
        <div class="total-item">
         <div class="total-label">
          íƒ„ìˆ˜í™”ë¬¼
         </div>
         <div class="total-value" id="total-carb">
          0
         </div>
        </div>
        <div class="total-item">
         <div class="total-label">
          ë‹¨ë°±ì§ˆ
         </div>
         <div class="total-value" id="total-prot">
          0
         </div>
        </div>
        <div class="total-item">
         <div class="total-label">
          ì§€ë°©
         </div>
         <div class="total-value" id="total-fat">
          0
         </div>
        </div>
       </div>
      </div>
      <div class="tray-grid">
       <div class="tray-slot" data-slot="slot-side-1" data-type="ë°˜ì°¬">
        <div class="slot-label">
         ğŸ¥˜ ë°˜ì°¬ 1
        </div>
        <div class="slot-content" id="slot-side-1-content"></div>
       </div>
       <div class="tray-slot" data-slot="slot-side-2" data-type="ë°˜ì°¬">
        <div class="slot-label">
         ğŸ¥˜ ë°˜ì°¬ 2
        </div>
        <div class="slot-content" id="slot-side-2-content"></div>
       </div>
       <div class="tray-slot" data-slot="slot-side-3" data-type="ë°˜ì°¬">
        <div class="slot-label">
         ğŸ¥˜ ë°˜ì°¬ 3
        </div>
        <div class="slot-content" id="slot-side-3-content"></div>
       </div>
       <div class="tray-slot" data-slot="slot-rice" data-type="ë°¥">
        <div class="slot-label">
         ğŸš ë°¥
        </div>
        <div class="slot-content" id="slot-rice-content"></div>
       </div>
       <div class="tray-slot" data-slot="slot-soup" data-type="êµ­">
        <div class="slot-label">
         ğŸ² êµ­
        </div>
        <div class="slot-content" id="slot-soup-content"></div>
       </div>
      </div>
      <div class="actions"><button class="btn btn-check" id="check-btn">ì •ë‹µ í™•ì¸</button> <button class="btn btn-reset" id="reset-btn">ë‹¤ì‹œ ì‹œì‘</button> <button class="btn btn-hint" id="hint-btn">íŒíŠ¸ ë³´ê¸°</button>
      </div>
     </div>
    </div>
    <div class="footer">
     Â© ìœ íŠœë¸Œ ìŠ¤íƒ ë“œì—…êµì‹¤. ì„œì§€í›ˆ All rights reserved.
    </div>
   </div>
   <div class="result-modal" id="result-modal">
    <div class="result-content" id="result-content">
     <div class="result-message" id="result-message"></div><button class="btn btn-check" onclick="closeModal()">í™•ì¸</button>
    </div>
   </div>
  </div>
  <script>
    const MENU_ITEMS = [
      // ë°¥ë¥˜ (íƒ„:3, ë‹¨:0, ì§€:0)
      { id: 1, name: 'ìŒ€ë°¥', emoji: 'ğŸš', type: 'ë°¥', carb: [9, 3], prot: [0, 3], fat: [0, 3] },
      { id: 2, name: 'í˜„ë¯¸ë°¥', emoji: 'ğŸš', type: 'ë°¥', carb: [9, 3], prot: [0, 3], fat: [0, 3] },
      { id: 3, name: 'í‘ë¯¸ë°¥', emoji: 'ğŸš', type: 'ë°¥', carb: [9, 3], prot: [0, 3], fat: [0, 3] },
      { id: 4, name: 'ë³´ë¦¬ë°¥', emoji: 'ğŸš', type: 'ë°¥', carb: [9, 3], prot: [0, 3], fat: [0, 3] },
      { id: 5, name: 'ì¡ê³¡ë°¥', emoji: 'ğŸš', type: 'ë°¥', carb: [9, 3], prot: [0, 3], fat: [0, 3] },
      
      // êµ­ë¥˜ (íƒ„:2, ë‹¨:0, ì§€:1)
      { id: 6, name: 'ë¯¸ì—­êµ­', emoji: 'ğŸ²', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 7, name: 'ëœì¥ì°Œê°œ', emoji: 'ğŸ¥£', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 8, name: 'ê¹€ì¹˜ì°Œê°œ', emoji: 'ğŸ²', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 9, name: 'ìˆœë‘ë¶€ì°Œê°œ', emoji: 'ğŸ²', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 10, name: 'ìœ¡ê°œì¥', emoji: 'ğŸ²', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 11, name: 'ì½©ë‚˜ë¬¼êµ­', emoji: 'ğŸ²', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      { id: 37, name: 'ë§ˆë¼íƒ•', emoji: 'ğŸŒ¶ï¸', type: 'êµ­', carb: [6, 3], prot: [0, 3], fat: [3, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 4/3 (1ê³¼1/3), ì§€ë°© 0
      { id: 12, name: 'ë‘ë¶€ì¡°ë¦¼', emoji: 'ğŸ§ˆ', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [0, 3] },
      { id: 13, name: 'ì½©ë‚˜ë¬¼ë¬´ì¹¨', emoji: 'ğŸŒ±', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [0, 3] },
      { id: 14, name: 'ì‹œê¸ˆì¹˜ë‚˜ë¬¼', emoji: 'ğŸ¥¬', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [0, 3] },
      { id: 15, name: 'ëœì¥ë¬´ì¹¨', emoji: 'ğŸ¥—', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [0, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 7/3 (2ì™€1/3), ì§€ë°© 0
      { id: 16, name: 'ë²„ì„¯ë³¶ìŒ', emoji: 'ğŸ„', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [0, 3] },
      { id: 17, name: 'ìˆ™ì£¼ë‚˜ë¬¼', emoji: 'ğŸŒ±', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [0, 3] },
      { id: 18, name: 'ë¯¸ì—­ì¤„ê¸°ë³¶ìŒ', emoji: 'ğŸ¥¬', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [0, 3] },
      { id: 19, name: 'ë¬´ìƒì±„', emoji: 'ğŸ¥—', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [0, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 4/3 (1ê³¼1/3), ì§€ë°© 3/3 (1)
      { id: 20, name: 'ê³„ë€ì°œ', emoji: 'ğŸ¥š', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      { id: 21, name: 'ì˜¤ì§•ì–´ë³¶ìŒ', emoji: 'ğŸ¦‘', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      { id: 22, name: 'ë©¸ì¹˜ë³¶ìŒ', emoji: 'ğŸŸ', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 7/3 (2ì™€1/3), ì§€ë°© 3/3 (1)
      { id: 23, name: 'ë‹­ê°€ìŠ´ì‚´êµ¬ì´', emoji: 'ğŸ—', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [3, 3] },
      { id: 24, name: 'ë‘ë¶€ìŠ¤í…Œì´í¬', emoji: 'ğŸ§ˆ', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [3, 3] },
      { id: 25, name: 'ìƒˆìš°ë³¶ìŒ', emoji: 'ğŸ¤', type: 'ë°˜ì°¬', carb: [0, 3], prot: [7, 3], fat: [3, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 4/3 (1ê³¼1/3), ì§€ë°© 3/3 (1)
      { id: 26, name: 'ê°ìì¡°ë¦¼', emoji: 'ğŸ¥”', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      { id: 27, name: 'ê¹€ì¹˜ë³¶ìŒ', emoji: 'ğŸ¥¬', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      { id: 28, name: 'ì–´ë¬µë³¶ìŒ', emoji: 'ğŸ¢', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      { id: 29, name: 'ê¹»ìë‚˜ë¬¼', emoji: 'ğŸŒ¿', type: 'ë°˜ì°¬', carb: [0, 3], prot: [4, 3], fat: [3, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 1/3, ì§€ë°© 2/3
      { id: 30, name: 'ê³„ë€ë§ì´', emoji: 'ğŸ¥š', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [2, 3] },
      { id: 31, name: 'ê²¬ê³¼ë¥˜ë³¶ìŒ', emoji: 'ğŸ¥œ', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [2, 3] },
      
      // ë°˜ì°¬ë¥˜ - ë‹¨ë°±ì§ˆ 1/3, ì§€ë°© 3/3 (1)
      { id: 32, name: 'ê³ ë“±ì–´êµ¬ì´', emoji: 'ğŸŸ', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [3, 3] },
      { id: 33, name: 'ì‚¼ê²¹ì‚´êµ¬ì´', emoji: 'ğŸ¥©', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [3, 3] },
      { id: 34, name: 'ì¹˜í‚¨ë„ˆê²Ÿ', emoji: 'ğŸ—', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [3, 3] },
      { id: 35, name: 'ì¹˜í‚¨', emoji: 'ğŸ—', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [3, 3] },
      { id: 36, name: 'ë‘ë°”ì´ì«€ë“ì¿ í‚¤', emoji: 'ğŸª', type: 'ë°˜ì°¬', carb: [0, 3], prot: [1, 3], fat: [3, 3] },
    ];

    const GOAL = { carb: 5, prot: 3, fat: 2 };
    
    // ëŒ€ë¶„ìˆ˜ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function toMixedFraction(numerator, denominator) {
      if (numerator === 0) {
        return '0';
      }
      
      const wholeNumber = Math.floor(numerator / denominator);
      const remainder = numerator % denominator;
      
      if (remainder === 0) {
        return `${wholeNumber}`;
      }
      
      if (wholeNumber === 0) {
        return `<span class="fraction"><span class="fraction-numerator">${remainder}</span><span class="fraction-denominator">${denominator}</span></span>`;
      }
      
      return `<span class="mixed-fraction"><span class="whole-number">${wholeNumber}</span><span class="fraction"><span class="fraction-numerator">${remainder}</span><span class="fraction-denominator">${denominator}</span></span></span>`;
    }
    
    // ë¶„ìˆ˜ í•©ê³„ë¥¼ ëŒ€ë¶„ìˆ˜ë¡œ í‘œì‹œ
    function sumToMixedFraction(sum) {
      if (sum === 0) {
        return '0';
      }
      
      // ë¶„ëª¨ë¥¼ 3ìœ¼ë¡œ ê³ ì •í•˜ê³  ê³„ì‚°
      const denominator = 3;
      const numerator = Math.round(sum * denominator);
      
      return toMixedFraction(numerator, denominator);
    }
    
    const slots = {
      'slot-side-1': null,
      'slot-side-2': null,
      'slot-side-3': null,
      'slot-rice': null,
      'slot-soup': null,
    };

    const defaultConfig = {
      app_title: 'ğŸ‘¨â€ğŸ³ ë¶„ìˆ˜ ê¸‰ì‹ ìš”ë¦¬ì‚¬ Season2',
      goal_label: 'ğŸ¯ ì˜ì–‘ ëª©í‘œ',
      instruction_text: 'ë¯¸ì…˜: ì´ˆë“±í•™ìƒ í•œë¼ ê¶Œì¥ ì˜ì–‘ì†ŒëŠ” íƒ„ìˆ˜í™”ë¬¼:5 ë‹¨ë°±ì§ˆ:3 ì§€ë°©:2 ì…ë‹ˆë‹¤. ê¶Œì¥ ì˜ì–‘ì†Œì— ë§ì¶° ê¸‰ì‹ ë©”ë‰´íŒì„ êµ¬ì„±í•´ë³´ì„¸ìš”.',
      check_button_text: 'ì •ë‹µ í™•ì¸',
      reset_button_text: 'ë‹¤ì‹œ ì‹œì‘',
      hint_button_text: 'íŒíŠ¸ ë³´ê¸°'
    };

    async function onConfigChange(config) {
      document.getElementById('app-title').textContent = config.app_title || defaultConfig.app_title;
      document.getElementById('goal-label').textContent = config.goal_label || defaultConfig.goal_label;
      document.getElementById('instruction-text').innerHTML = config.instruction_text || defaultConfig.instruction_text;
      document.getElementById('check-btn').textContent = config.check_button_text || defaultConfig.check_button_text;
      document.getElementById('reset-btn').textContent = config.reset_button_text || defaultConfig.reset_button_text;
      document.getElementById('hint-btn').textContent = config.hint_button_text || defaultConfig.hint_button_text;
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['app_title', config.app_title || defaultConfig.app_title],
        ['goal_label', config.goal_label || defaultConfig.goal_label],
        ['instruction_text', config.instruction_text || defaultConfig.instruction_text],
        ['check_button_text', config.check_button_text || defaultConfig.check_button_text],
        ['reset_button_text', config.reset_button_text || defaultConfig.reset_button_text],
        ['hint_button_text', config.hint_button_text || defaultConfig.hint_button_text]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: () => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues
      });
    }

    function renderMenuItems() {
      const riceMenu = document.getElementById('rice-menu');
      const soupMenu = document.getElementById('soup-menu');
      const sideMenu = document.getElementById('side-menu');

      MENU_ITEMS.forEach(item => {
        const itemEl = document.createElement('div');
        itemEl.className = 'menu-item';
        itemEl.draggable = true;
        itemEl.innerHTML = `
          <div class="item-name">${item.emoji} ${item.name}</div>
          <div class="item-nutrients">
            <span class="nutrient-carb">íƒ„: ${toMixedFraction(item.carb[0], item.carb[1])}</span> | 
            <span class="nutrient-prot">ë‹¨: ${toMixedFraction(item.prot[0], item.prot[1])}</span> | 
            <span class="nutrient-fat">ì§€: ${toMixedFraction(item.fat[0], item.fat[1])}</span>
          </div>
        `;

        // í´ë¦­ìœ¼ë¡œ ì¶”ê°€
        itemEl.addEventListener('click', () => {
          addItemToTray(item);
        });

        itemEl.addEventListener('dragstart', (e) => {
          e.dataTransfer.setData('item', JSON.stringify(item));
          itemEl.style.opacity = '0.5';
        });

        itemEl.addEventListener('dragend', () => {
          itemEl.style.opacity = '1';
        });

        if (item.type === 'ë°¥') riceMenu.appendChild(itemEl);
        else if (item.type === 'êµ­') soupMenu.appendChild(itemEl);
        else sideMenu.appendChild(itemEl);
      });
    }

    function setupDropZones() {
      const dropZones = document.querySelectorAll('.tray-slot');
      
      dropZones.forEach(zone => {
        zone.addEventListener('dragover', (e) => {
          e.preventDefault();
        });

        zone.addEventListener('dragenter', (e) => {
          e.preventDefault();
          zone.classList.add('drag-over');
        });

        zone.addEventListener('dragleave', () => {
          zone.classList.remove('drag-over');
        });

        zone.addEventListener('drop', (e) => {
          e.preventDefault();
          zone.classList.remove('drag-over');
          
          const item = JSON.parse(e.dataTransfer.getData('item'));
          const slotId = zone.dataset.slot;
          const slotType = zone.dataset.type;

          if (item.type !== slotType) {
            showInlineMessage(`${slotType} ìŠ¬ë¡¯ì—ëŠ” ${item.type}ë§Œ ë†“ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!`, false);
            return;
          }

          if (slots[slotId]) {
            showInlineMessage('ì´ë¯¸ ìŒì‹ì´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì œê±°í•´ì£¼ì„¸ìš”.', false);
            return;
          }

          slots[slotId] = item;
          renderSlot(slotId, item);
          calculateTotals();
        });
      });
    }

    function renderSlot(slotId, item) {
      const contentEl = document.getElementById(`${slotId}-content`);
      const slotEl = document.querySelector(`[data-slot="${slotId}"]`);
      
      if (item) {
        slotEl.classList.add('filled');
        contentEl.innerHTML = `
          <div class="slot-emoji">${item.emoji}</div>
          <div class="slot-name">${item.name}</div>
          <div class="slot-nutrients">
            <span class="nutrient-carb">íƒ„: ${toMixedFraction(item.carb[0], item.carb[1])}</span> | 
            <span class="nutrient-prot">ë‹¨: ${toMixedFraction(item.prot[0], item.prot[1])}</span> | 
            <span class="nutrient-fat">ì§€: ${toMixedFraction(item.fat[0], item.fat[1])}</span>
          </div>
          <button class="remove-btn" onclick="removeItem('${slotId}')">âœ• ì œê±°</button>
        `;
      } else {
        slotEl.classList.remove('filled');
        contentEl.innerHTML = '';
      }
    }

    function removeItem(slotId) {
      slots[slotId] = null;
      renderSlot(slotId, null);
      calculateTotals();
    }

    // í´ë¦­ìœ¼ë¡œ ë©”ë‰´ ì¶”ê°€ ì‹œ ìë™ìœ¼ë¡œ ë¹ˆ ìŠ¬ë¡¯ ì°¾ê¸°
    function addItemToTray(item) {
      // í•´ë‹¹ íƒ€ì…ì— ë§ëŠ” ìŠ¬ë¡¯ ì°¾ê¸°
      let targetSlots = [];
      if (item.type === 'ë°¥') {
        targetSlots = ['slot-rice'];
      } else if (item.type === 'êµ­') {
        targetSlots = ['slot-soup'];
      } else if (item.type === 'ë°˜ì°¬') {
        targetSlots = ['slot-side-1', 'slot-side-2', 'slot-side-3'];
      }

      // ë¹ˆ ìŠ¬ë¡¯ ì°¾ê¸°
      const emptySlot = targetSlots.find(slotId => slots[slotId] === null);

      if (emptySlot) {
        slots[emptySlot] = item;
        renderSlot(emptySlot, item);
        calculateTotals();
      } else {
        showInlineMessage(`${item.type} ìŠ¬ë¡¯ì´ ëª¨ë‘ ì°¼ìŠµë‹ˆë‹¤! ê¸°ì¡´ ë©”ë‰´ë¥¼ ì œê±°í•´ì£¼ì„¸ìš”.`, false);
      }
    }

    function calculateTotals() {
      let carbSum = 0, protSum = 0, fatSum = 0;
      
      Object.values(slots).forEach(item => {
        if (item) {
          carbSum += item.carb[0] / item.carb[1];
          protSum += item.prot[0] / item.prot[1];
          fatSum += item.fat[0] / item.fat[1];
        }
      });

      document.getElementById('total-carb').innerHTML = sumToMixedFraction(carbSum);
      document.getElementById('total-prot').innerHTML = sumToMixedFraction(protSum);
      document.getElementById('total-fat').innerHTML = sumToMixedFraction(fatSum);

      // ì˜ì–‘ ëª©í‘œíŒì—ë„ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
      document.getElementById('current-carb').innerHTML = sumToMixedFraction(carbSum);
      document.getElementById('current-prot').innerHTML = sumToMixedFraction(protSum);
      document.getElementById('current-fat').innerHTML = sumToMixedFraction(fatSum);

      // ëª©í‘œ ë‹¬ì„± ì‹œê° íš¨ê³¼
      const carbGoal = document.querySelector('.goal-item.carb');
      const protGoal = document.querySelector('.goal-item.prot');
      const fatGoal = document.querySelector('.goal-item.fat');

      if (Math.abs(carbSum - GOAL.carb) < 0.01) {
        carbGoal.classList.add('achieved');
      } else {
        carbGoal.classList.remove('achieved');
      }

      if (Math.abs(protSum - GOAL.prot) < 0.01) {
        protGoal.classList.add('achieved');
      } else {
        protGoal.classList.remove('achieved');
      }

      if (Math.abs(fatSum - GOAL.fat) < 0.01) {
        fatGoal.classList.add('achieved');
      } else {
        fatGoal.classList.remove('achieved');
      }

      return { carb: carbSum, prot: protSum, fat: fatSum };
    }

    function checkAnswer() {
      const totals = calculateTotals();
      const carbMatch = Math.abs(totals.carb - GOAL.carb) < 0.01;
      const protMatch = Math.abs(totals.prot - GOAL.prot) < 0.01;
      const fatMatch = Math.abs(totals.fat - GOAL.fat) < 0.01;

      const modal = document.getElementById('result-modal');
      const content = document.getElementById('result-content');
      const message = document.getElementById('result-message');

      if (carbMatch && protMatch && fatMatch) {
        content.className = 'result-content success';
        message.textContent = 'ğŸ‰ ì™„ë²½í•©ë‹ˆë‹¤! ì˜ì–‘ ëª©í‘œë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤!';
      } else {
        const hints = [];
        if (!carbMatch) {
          const diff = GOAL.carb - totals.carb;
          const diffFraction = sumToMixedFraction(Math.abs(diff));
          hints.push(`íƒ„ìˆ˜í™”ë¬¼ ${diff > 0 ? 'ë” í•„ìš”' : 'ì´ˆê³¼'}: ${diffFraction}`);
        }
        if (!protMatch) {
          const diff = GOAL.prot - totals.prot;
          const diffFraction = sumToMixedFraction(Math.abs(diff));
          hints.push(`ë‹¨ë°±ì§ˆ ${diff > 0 ? 'ë” í•„ìš”' : 'ì´ˆê³¼'}: ${diffFraction}`);
        }
        if (!fatMatch) {
          const diff = GOAL.fat - totals.fat;
          const diffFraction = sumToMixedFraction(Math.abs(diff));
          hints.push(`ì§€ë°© ${diff > 0 ? 'ë” í•„ìš”' : 'ì´ˆê³¼'}: ${diffFraction}`);
        }

        content.className = 'result-content fail';
        message.innerHTML = 'ğŸ¤” ì•„ì§ ëª©í‘œì— ë„ë‹¬í•˜ì§€ ëª»í–ˆì–´ìš”!<br><br>' + hints.join('<br>');
      }

      modal.classList.add('show');
    }

    function closeModal() {
      document.getElementById('result-modal').classList.remove('show');
    }

    function resetGame() {
      Object.keys(slots).forEach(slotId => {
        slots[slotId] = null;
        renderSlot(slotId, null);
      });
      calculateTotals();
      document.getElementById('hint-box').classList.remove('show');
    }

    function showHint() {
      const hintBox = document.getElementById('hint-box');
      const hintText = document.getElementById('hint-text');

      // ê²€ì¦ëœ ì •ë‹µ ì¡°í•© (íƒ„5, ë‹¨3, ì§€2) - ë¶„ëª¨ 3 ê¸°ì¤€
      const hintContent = `
        <div style="margin-bottom: 8px;">ğŸ’¡ <strong>ë¶„ìˆ˜ ê³„ì‚° íŒ (ë¶„ëª¨ëŠ” ëª¨ë‘ 3):</strong></div>
        <div style="margin-left: 16px; line-height: 1.6;">
          â€¢ ğŸ¯ <strong>ëª©í‘œ: íƒ„15/3, ë‹¨9/3, ì§€6/3</strong> (íƒ„5, ë‹¨3, ì§€2)<br>
          â€¢ ğŸš <strong>ë°¥ì€ íƒ„ìˆ˜í™”ë¬¼ë§Œ 3(=9/3)</strong> ì œê³µí•´ìš”<br>
          â€¢ ğŸ² <strong>êµ­ì€ íƒ„ìˆ˜í™”ë¬¼ 2(=6/3)ì™€ ì§€ë°© 1(=3/3)</strong> ì œê³µí•´ìš”<br>
          â€¢ ğŸ¥˜ <strong>ë°˜ì°¬ìœ¼ë¡œ ë‹¨ë°±ì§ˆ 3ê³¼ ì§€ë°© 1ì„ ì±„ì›Œì•¼ í•´ìš”!</strong><br>
          â€¢ ğŸ¥˜ <strong>ë°˜ì°¬ì€ ìµœëŒ€ 3ê°œë§Œ</strong> ë‹´ì„ ìˆ˜ ìˆì–´ìš”!
        </div>
        <div style="margin-top: 16px; padding-top: 12px; border-top: 2px solid #ffc107;">
          <div style="margin-bottom: 8px;">âœ¨ <strong>ì •ë‹µ ì¡°í•© ì˜ˆì‹œ:</strong></div>
          <div style="margin-left: 16px; line-height: 1.8; font-size: 13px;">
            <div style="background: #e8f5e9; padding: 10px; border-radius: 6px; border: 2px solid #4caf50;">
              <strong>ğŸ’ ì™„ë²½í•œ ì¡°í•©:</strong><br>
              ğŸš ìŒ€ë°¥(íƒ„3) + ğŸ² ë¯¸ì—­êµ­(íƒ„2, ì§€1) + ğŸ¥˜ ë‘ë¶€ì¡°ë¦¼(ë‹¨1â…“) + ğŸ¥˜ ì½©ë‚˜ë¬¼ë¬´ì¹¨(ë‹¨1â…“) + ğŸ¥˜ ì‚¼ê²¹ì‚´êµ¬ì´(ë‹¨â…“, ì§€1)<br>
              <span style="font-size: 12px; color: #2e7d32; font-weight: bold;">
                âœ… íƒ„: 3 + 2 = 5 âœ¨<br>
                âœ… ë‹¨: 1â…“ + 1â…“ + â…“ = 3 âœ¨<br>
                âœ… ì§€: 1 + 1 = 2 âœ¨
              </span>
            </div>
            <div style="background: #fff3e0; padding: 10px; border-radius: 6px; margin-top: 10px;">
              <strong>ğŸ“ í•µì‹¬ íŒíŠ¸:</strong><br>
              â€¢ <strong>ë°¥(íƒ„3) + êµ­(íƒ„2)</strong>ìœ¼ë¡œ íƒ„ìˆ˜í™”ë¬¼ 5 ì™„ì„±!<br>
              â€¢ êµ­ì„ ì„ íƒí•˜ë©´ <strong>ì§€ë°© 1</strong>ì´ ìë™ ì¶”ê°€í•˜ë¯€ë¡œ ë°˜ì°¬ì—ì„œ ì§€ë°© 1ë§Œ í•„ìš”<br>
              â€¢ ë°˜ì°¬ 3ê°œë¡œ <strong>ë‹¨ë°±ì§ˆ 3 + ì§€ë°© 1</strong> ì±„ìš°ê¸°!<br>
              â€¢ <strong>1â…“ + 1â…“ + â…“ = 3</strong> ëŒ€ë¶„ìˆ˜ ê³„ì‚°ì„ ì—°ìŠµí•´ë³´ì„¸ìš”!
            </div>
          </div>
        </div>
      `;

      hintText.innerHTML = hintContent;
      hintBox.classList.add('show');
    }

    function showInlineMessage(message, success) {
      const hintBox = document.getElementById('hint-box');
      const hintText = document.getElementById('hint-text');
      hintText.textContent = message;
      hintBox.classList.add('show');
      setTimeout(() => {
        hintBox.classList.remove('show');
      }, 3000);
    }

    document.getElementById('check-btn').addEventListener('click', checkAnswer);
    document.getElementById('reset-btn').addEventListener('click', resetGame);
    document.getElementById('hint-btn').addEventListener('click', showHint);

    renderMenuItems();
    setupDropZones();
    calculateTotals();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bac3135658bea10',t:'MTc2Nzg4MDUyMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>